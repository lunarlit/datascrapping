# Stage 3 - HTML 문서를 가져와보자

스테이지 3에서는 **requests** 라는 외부 라이브러리를 사용하여 웹페이지에서 HTML 문서를 실제로 가져옵니다.

이를 위해 먼저 라이브러리를 구성하는 **클래스**가 무엇인지 알아보고, 라이브러리가 무엇인지도 배워보겠습니다.

## 파이썬 기본 클래스를 사용해보자

Stage 1에서 텍스트 값을 갖는 변수를 만들어 보았습니다. 프로그래밍에서는 사실 텍스트를 String\(문자열\) 이라고 부릅니다. 앞으로는 이 용어를 사용하겠습니다.

데이터 수집을 하다보면 텍스트를 조작할 일이 많습니다.  
다음의 예를 확인해주세요.

```text
internal string class example
```



weekly. 으로 시작하는 문법은 처음보지만, 잠깐 제쳐두겠습니다.

수집 결과 들어온 텍스트가 좌우에 여백이 남아있고, "2주차 - " 를 "2. " 와 같이 포매팅하고 싶은 상황입니다.

이 때 사용할 수 있는 두 함수가 strip\(\)과 replace\(\) 입니다.

```text
"    " -> ""
```

strip\(\) 함수는 입력값이 없으며, "." 이전에 있는 텍스트의 좌우 여백을 없애줍니다.

```text
"" -> ""
```

replace\(\) 함수는 두 개의 텍스트\(old, new\)를 입력받아  "." 이전에 있는 텍스트에서 old와 일치하는 부분을 new로 바꾸어 줍니다. 유용하죠?

함수의 또 다른 장점은 **"추상성"** 에 있습니다.  
함수의 **"구체적"**인 구현 방법을 알지 못해도, 어떤 입력값을 받아 어떻게 출력해주는지만 알면 누구나 사용할 수 있기 때문입니다.

따라서 코드를 읽을 다른 사람이나, 기억을 상실할 미래의 나를 위해 함수를 잘 작성해 주는 것이 좋습니다.



그런데 이 함수는 대체 어디에 정의되어있는 걸까요? 그리고 weekly. 이 궁금해서 참을 수가 없습니다.

이 weekly가 바로 클래스의 일종입니다.

```text
text declaration
```

를 선언하는 순간, weekly 변수는 String 이 되어 String을 조작할 수 있는 수많은 함수가 모여있는 공간에 접근할 수 있게 됩니다.

![weekly &#xB2E4;&#xC74C;&#xC5D0; . &#xC744; &#xC785;&#xB825;&#xD558;&#xBA74; PyCharm&#xC774; String &#xD074;&#xB798;&#xC2A4;&#xC758; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5; &#xD568;&#xC218;&#xB4E4;&#xC744; &#xBAA8;&#xB450; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;.](../.gitbook/assets/image%20%28203%29.png)

이 함수들은 파이썬 개발자들이 미리 작성하여 String 클래스 안에 모아둔 것입니다.

즉, 클래스란 어떠한 기능과 연관된 변수나 함수들을 모아놓은 집합이라고 생각하시면 됩니다.

그리고 클래스 변수 다음에 . 을 찍으면, 클래스 내부에 있는 변수나 함수에 접근하겠다는 의미가 됩니다.

따라서 weekly.strip\(\)은, String 변수 weekly가 속한 String 클래스 안에 들어있는 strip\(\) 함수를 사용하겠다는 뜻입니다.



## 외부 라이브러리

이렇게 파이썬 개발자들이 파이썬에 자체적으로 몇 가지 클래스를 내장해 두었지만, 우리가 사용하고 싶은 여러 다양한 기능들이 모두 있을까요?

파이썬 코어 개발자는 그렇게 많지가 않기 때문에 수천만명이 사용하고 싶은 기능을 다 만들어줄 능력도, 생각도 없습니다.

대신 그들은 전 세계의 다른 개발자들에게 책임을 맡깁니다.

![](../.gitbook/assets/image%20%2852%29.png)

전 세계의 개발자들은 별 다른 계약 없이도, 파이썬을 이용해 유용한 기능들을 만들고 공유할 수 있습니다.

서로 대가없이 코드를 공유하며 자신의 작업 속도, 더 나아가 파이썬 생태계를 발전시키는 오픈 소스 문화 덕분이죠.

덕분에 위 그림의 우측에 있는 강력하고 유명한 라이브러리들처럼, 파이썬의 힘은 무한히 커질 수 있습니다.  
\(이는 다른 언어도 마찬가지입니다. 다만 메이저 언어에 속하는 파이썬은 상대적으로 오픈소스에 공헌하는 개발자들이 많겠죠?\)

위에서 클래스에 대해 먼저 소개해드린 이유는 이런 오픈소스 라이브러리들이 **클래스의 집합** 형태로 제공되기 때문입니다.  
따라서 여러분은 클래스와 함수가 제공하는 **"추상성"**에 의해 HTML 문서 요청, HTML 문서 탐색과 같은 복잡한 기능을 text.strip\(\)을 사용하듯 편하게 쓸 수 있습니다.

구체적인 내용은 requests 라이브러리를 사용하며 알아보겠습니다.



## 외부 라이브러리 설치 방법

![](../.gitbook/assets/image%20%2842%29.png)

PyCharm의 File 메뉴를 열어 Settings 를 선택합니다.

Settings 콘솔이 열리면 좌측 메뉴에서 Project: 프로젝트명 &gt; Project Interpreter를 선택합니다.

선택 후 우측의 초록색 + 버튼을 누릅니다.



![](../.gitbook/assets/image%20%28101%29.png)

이와 같은 패키지 설치 콘솔이 나올 것입니다.

검색 창에 requests를 검색하여 아래의 Install Package를 눌러줍니다.



![](../.gitbook/assets/image%20%2815%29.png)

잠시 기다리면 이렇게 녹색 알림으로 설치 완료 메세지가 나옵니다.



![](../.gitbook/assets/image%20%2890%29.png)

마찬가지로 beautifulsoup4 도 설치해 주세요. \(Stage 4에서 사용합니다.\)



## requests 라이브러리의 사용

```python
import requests
```

먼저 파일의 최상단에 다음과 같이 requests 라이브러리를 사용하겠다는 명령을 작성합니다.



```python
req = requests.get('https://tv.naver.com/r/')
raw = req.text

print(raw)
```

아래에 다음과 같이 코드를 작성해줍니다.

requests 는 방금 들여온 외부 라이브러리이자, **웹페이지에 요청할 수 있는 기능들을 모아놓은 클래스** 입니다.

그 중 웹페이지의 내용을 요청하는 .get\(\) 함수를 사용하고, 매개 변수로 웹페이지의 주소를 입력합니다.

![](../.gitbook/assets/image%20%28112%29.png)

사용한 주소는 네이버TV TOP100 의 주소입니다.

requests.get의 결과로 얻어진 req \(변수명이므로 마음대로 지어도 괜찮습니다.\) 는 **요청의 결과 정보와 결과를 사용하는 여러 함수를 가지고 있는 또다른 클래스**입니다.

여기서 요청 결과를 단순 텍스트로 보여주는 .text 변수를 사용해 변수 raw에 저장했습니다.  
\(가공되지 않는 날 것의 텍스트라는 의미에서 이렇게 지었습니다. 변수나 함수명은 a, b 등 무의미한 단어보다 항상 의미를 알 수 있도록 짓는 것이 좋습니다.\)

이제 print 함수를 사용해 이 raw를 출력해보겠습니다.

![](../.gitbook/assets/image%20%2897%29.png)

1주차에 보던 HTML과 CSS 선택자로 이루어진 파일이 출력되었습니다!

아직 아무 의미도 갖지 못하는 정보이지만, 첫 데이터 수집에 성공한 것을 축하드립니다!

스크롤을 내려보면 분량이 엄청나게 많은 것을 알 수 있습니다.   
실제로 웹서비스를 만들 때 이렇게 많은 코드가 사용되는데요.   
다음 스테이지에서는 이 코드의 모래사장에서 바늘을 찾아보도록 하겠습니다.



